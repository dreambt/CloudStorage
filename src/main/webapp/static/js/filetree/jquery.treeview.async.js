(function(e){function f(a,b,i,c){function j(h){var g=e("<li/>").attr("id",this.id||"").html("<span>"+this.text+"</span>").appendTo(h);if(this.classes){g.children("span").addClass(this.classes)}if(this.expanded){g.addClass("open")}if(this.hasChildren||this.children&&this.children.length){var l=e("<ul/>").appendTo(g);if(this.hasChildren){g.addClass("hasChildren");j.call({classes:"placeholder",text:"&nbsp;",children:[]},l)}if(this.children&&this.children.length){e.each(this.children,j,[l])}}}e.ajax(e.extend(true,{url:a.url,dataType:"json",data:{root:b},success:function(g){i.empty();e.each(g,j,[i]);e(c).treeview({add:i})}},a.ajax))}var d=e.fn.treeview;e.fn.treeview=function(b){if(!b.url){return d.apply(this,arguments)}var a=this;if(!a.children().size()){f(b,"source",this,a)}var c=b.toggle;return d.call(this,e.extend({},b,{collapsed:true,toggle:function(){var i=e(this);if(i.hasClass("hasChildren")){var j=i.removeClass("hasChildren").find("ul");f(b,this.id,j,a)}if(c){c.apply(this,arguments)}}}))}})(jQuery);