(function(c){function b(f,e,h,d){function g(j){var k=c("<li/>").attr("id",this.id||"").html("<span>"+this.text+"</span>").appendTo(j);if(this.classes){k.children("span").addClass(this.classes)}if(this.expanded){k.addClass("open")}if(this.hasChildren||this.children&&this.children.length){var i=c("<ul/>").appendTo(k);if(this.hasChildren){k.addClass("hasChildren");g.call({classes:"placeholder",text:"&nbsp;",children:[]},i)}if(this.children&&this.children.length){c.each(this.children,g,[i])}}}c.ajax(c.extend(true,{url:f.url,dataType:"json",data:{root:e},success:function(i){h.empty();c.each(i,g,[h]);c(d).treeview({add:h})}},f.ajax))}var a=c.fn.treeview;c.fn.treeview=function(f){if(!f.url){return a.apply(this,arguments)}var d=this;if(!d.children().size()){b(f,"source",this,d)}var e=f.toggle;return a.call(this,c.extend({},f,{collapsed:true,toggle:function(){var h=c(this);if(h.hasClass("hasChildren")){var g=h.removeClass("hasChildren").find("ul");b(f,this.id,g,d)}if(e){e.apply(this,arguments)}}}))}})(jQuery);