(function(d){d.extend(d.fn,{swapClass:function(b,f){var a=this.filter("."+b);this.filter("."+f).removeClass(f).addClass(b);a.removeClass(b).addClass(f);return this},replaceClass:function(a,b){return this.filter("."+a).removeClass(a).addClass(b).end()},hoverClass:function(a){a=a||"hover";return this.hover(function(){d(this).addClass(a)},function(){d(this).removeClass(a)})},heightToggle:function(b,a){b?this.animate({height:"toggle"},b,a):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"]();if(a){a.apply(this,arguments)}})},heightHide:function(b,a){if(b){this.animate({height:"hide"},b,a)}else{this.hide();if(a){this.each(a)}}},prepareBranches:function(a){if(!a.prerendered){this.filter(":last-child:not(ul)").addClass(c.last);this.filter((a.collapsed?"":"."+c.closed)+":not(."+c.open+")").find(">ul").hide()}return this.filter(":has(>ul)")},applyClasses:function(f,b){this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(e){if(this==e.target){b.apply(d(this).next())}}).add(d("a",this)).hoverClass();if(!f.prerendered){this.filter(":has(>ul:hidden)").addClass(c.expandable).replaceClass(c.last,c.lastExpandable);this.not(":has(>ul:hidden)").addClass(c.collapsable).replaceClass(c.last,c.lastCollapsable);var a=this.find("div."+c.hitarea);if(!a.length){a=this.prepend('<div class="'+c.hitarea+'"/>').find("div."+c.hitarea)}a.removeClass().addClass(c.hitarea).each(function(){var e="";d.each(d(this).parent().attr("class").split(" "),function(){e+=this+"-hitarea "});d(this).addClass(e)})}this.find("div."+c.hitarea).click(b)},treeview:function(a){a=d.extend({cookieId:"treeview"},a);if(a.toggle){var o=a.toggle;a.toggle=function(){return o.apply(d(this).parent()[0],arguments)}}function b(f,g){function e(h){return function(){s.apply(d("div."+c.hitarea,f).filter(function(){return h?d(this).parent("."+h).length:true}));return false}}d("a:eq(0)",g).click(e(c.collapsable));d("a:eq(1)",g).click(e(c.expandable));d("a:eq(2)",g).click(e())}function s(){d(this).parent().find(">.hitarea").swapClass(c.collapsableHitarea,c.expandableHitarea).swapClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().swapClass(c.collapsable,c.expandable).swapClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightToggle(a.animated,a.toggle);if(a.unique){d(this).parent().siblings().find(">.hitarea").replaceClass(c.collapsableHitarea,c.expandableHitarea).replaceClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().replaceClass(c.collapsable,c.expandable).replaceClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightHide(a.animated,a.toggle)}}this.data("toggler",s);function m(){function e(g){return g?1:0}var f=[];n.each(function(h,g){f[h]=d(g).is(":has(>ul:visible)")?1:0});d.cookie(a.cookieId,f.join(""),a.cookieOptions)}function t(){var f=d.cookie(a.cookieId);if(f){var e=f.split("");n.each(function(h,g){d(g).find(">ul")[parseInt(e[h])?"show":"hide"]()})}}this.addClass("treeview");var n=this.find("li").prepareBranches(a);switch(a.persist){case"cookie":var p=a.toggle;a.toggle=function(){m();if(p){p.apply(this,arguments)}};t();break;case"location":var r=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()});if(r.length){var q=r.addClass("selected").parents("ul, li").add(r.next()).show();if(a.prerendered){q.filter("li").swapClass(c.collapsable,c.expandable).swapClass(c.lastCollapsable,c.lastExpandable).find(">.hitarea").swapClass(c.collapsableHitarea,c.expandableHitarea).swapClass(c.lastCollapsableHitarea,c.lastExpandableHitarea)}}break}n.applyClasses(a,s);if(a.control){b(this,a.control);d(a.control).show()}return this}});d.treeview={};var c=(d.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"})})(jQuery);